/* Base + Win98/ME theme (default) */
:root{
  --bg:#008080;
  --ink:#000000;
  --muted:#2b2b2b;
  --maxw:1200px;
  --bar-brass:#c08a3e;
  --accent: hsl(28 95% 58%);

  /* Win98 palette */
  --win-face:#c0c0c0;
  --win-text:#000000;
  --win-inactive-text:#222222;
  --win-highlight:#ffffff;
  --win-shadow:#808080;
  --win-dark:#000000;
  --title-inactive:#808080;
  --title-active:#000080;

  --topbar-h: 44px;
  --bottombar-h: 48px;
}

*{box-sizing:border-box}
html,body{margin:0;padding:0;background:teal;color:var(--ink);font:14px/1.4 Tahoma,"Microsoft Sans Serif",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;-webkit-text-size-adjust:100%}
a{color:var(--ink);text-decoration:none}
a:hover{opacity:.9}
titlebar, .titlebar{touch-action:none}
*{-webkit-tap-highlight-color:transparent}

/* Disable text selection during drag/resize */
body.is-dragging, body.is-resizing { user-select:none !important; }

/* Desktop */
.desktop{position:relative;min-height:100vh;overflow:hidden;padding-top:calc(var(--topbar-h) + 8px);padding-bottom:calc(var(--bottombar-h) + 8px)}

/* wallpaper/scrim (sem imagem!) */
.wallpaper{position:fixed; inset:0; z-index:-3; display:none; background:none}
.scrim{position:fixed; inset:0; z-index:-2; display:none; background:none}

/* Waves por cima do background (body), mas abaixo das janelas */
.waves{ position:fixed; inset:0; z-index:5; pointer-events:none; }
.waves-canvas{ width:100%; height:100%; display:block; }

/* Tema moderno – sem wallpaper de foto, só gradientes escuros */
body.theme-modern .desktop{background:transparent}
body.theme-modern .wallpaper{display:block; background:
  radial-gradient(70% 60% at 60% 35%, rgba(192,138,62,.10), transparent 62%),
  radial-gradient(60% 50% at 20% 70%, rgba(125,179,155,.08), transparent 60%)}
body.theme-modern .scrim{display:block; background:
  linear-gradient(to bottom, rgba(10,10,10,.20), rgba(10,10,10,.88))}

/* --- TASKBARS --- */
.taskbar{
  display:flex; align-items:center; gap:8px;
  background:var(--win-face); color:var(--win-text);
  border:1px solid var(--win-dark);
  box-shadow:inset 0 1px 0 var(--win-highlight), inset 0 -1px 0 var(--win-shadow);
  z-index:1200;
}
.taskbar .spacer{flex:1}

.taskbar-top{
  position:fixed; left:0; right:0; top:0; height:var(--topbar-h);
  padding:6px 8px;
}
.taskbar-bottom{
  position:fixed; left:0; right:0; bottom:0; height:var(--bottombar-h);
  padding:6px 8px;
}

/* Botões de separador */
.tabs{display:flex; align-items:center; gap:6px; overflow:auto hidden}
.task-button{
  position:relative; padding:4px 10px; min-width:84px; height:28px;
  color:var(--win-text); cursor:pointer; background:var(--win-face);
  border:1px solid var(--win-dark);
  box-shadow:inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight);
  border-radius:0; text-align:center; display:inline-flex; align-items:center; justify-content:center;
}
.task-button:hover{filter:brightness(1.02)}
.task-button.pulsing-static{box-shadow:inset 1px 1px 0 var(--win-shadow), inset -1px -1px 0 var(--win-highlight)}
.task-button{ --pulse:0; --hue:40; }
.task-button.pulsing::before{content:""; position:absolute; left:0; right:0; bottom:-2px; height:2px; background:hsl(var(--hue,40) 80% 45% / .9); transform-origin:left center; transform:scaleX(var(--pulse,0));}

/* Hambúrguer TOP visível só quando tabs colapsam */
#tb-menu-top{ display:none; font-weight:700; line-height:1; text-align:center; }

/* Taskbar bottom: controls */
.task-controls{display:flex;align-items:center;gap:8px}
.theme-select, .lang-select{
  height:28px;border:1px solid var(--win-dark);background:var(--win-face);
  box-shadow:inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight);
  font:12px Tahoma,"Microsoft Sans Serif";color:var(--win-text); padding:0 8px;
}
.task-clock{min-width:92px;text-align:center;border:1px solid var(--win-dark);background:var(--win-face);box-shadow:inset 0 1px 0 var(--win-highlight), inset 0 -1px 0 var(--win-shadow);padding:2px 6px;height:28px;display:grid;place-items:center;font-variant-numeric:tabular-nums}

/* Mobile menu – base Win98 */
.mobile-only{display:none}
.mobile-menu{
  position:fixed; left:8px; top:calc(var(--topbar-h) + 10px); right:auto;
  background:var(--win-face); color:var(--win-text);
  border:1px solid var(--win-dark);
  box-shadow:inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight);
  border-radius:0; padding:10px;
  display:none; flex-direction:column; gap:6px;
  min-width:220px; min-height:120px; z-index:2000;
}
.mobile-menu[aria-hidden="false"]{display:flex !important}
.menu-item{ color:var(--win-text); padding:8px 10px; text-align:left; border:1px solid var(--win-dark); background:var(--win-face); box-shadow:inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight); border-radius:0;}
.menu-item:active{ filter:brightness(1.02) }

/* Windows (Win98 default) */
.win{
  --tint: var(--bar-brass);
  position:absolute; top:14vh; left:8vw; width:min(720px,90vw); max-width:90vw; max-height:72vh;
  display:flex; flex-direction:column; background:var(--win-face);
  border:1px solid var(--win-dark);
  box-shadow:inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight);
  border-radius:0
}
.win.hidden{display:none; --tint: transparent !important}
.titlebar{cursor:move;user-select:none;display:flex;align-items:center;justify-content:space-between;gap:8px;padding:4px 6px;height:24px;color:#fff;background: linear-gradient(180deg, var(--title-inactive), color-mix(in srgb, var(--title-inactive) 70%, #000 30%));box-shadow: inset -1px -1px 0 rgba(0,0,0,.35), inset 1px 1px 0 rgba(255,255,255,.25)}
.win.active .titlebar{background: linear-gradient(180deg, color-mix(in srgb, var(--tint) 70%, var(--title-active) 30%), color-mix(in srgb, var(--tint) 40%, var(--title-active) 60%))}
.titlebar .left{display:flex;align-items:center;gap:8px}
.title{letter-spacing:.2px;opacity:.95}
.window-controls{display:flex;gap:6px}
.ctl{width:20px;height:18px;border-radius:0;background:var(--win-face);color:#000;display:grid;place-items:center;cursor:pointer;border:1px solid var(--win-dark);box-shadow: inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight)}
.ctl:hover{filter:brightness(1.05)}

.content{padding:8px 10px;overflow:auto}
.content p{color:var(--win-text)}
.muted{color:var(--win-inactive-text)}

/* Resize handles */
.resize-handle{ position:absolute; width:14px; height:14px; bottom:2px; background:transparent; }
.resize-handle.br{ right:2px; cursor:nwse-resize; }
.resize-handle.bl{ left:2px; cursor:nesw-resize; }
.resize-handle::after{
  content:""; position:absolute; right:2px; bottom:2px; width:10px; height:10px; 
  border-right:2px solid rgba(0,0,0,.5); border-bottom:2px solid rgba(0,0,0,.5);
}
.resize-handle.bl::after{
  right:auto; left:2px; border-right:none; border-left:2px solid rgba(0,0,0,.5); border-bottom:2px solid rgba(0,0,0,.5);
}

/* Lists */
.list{display:grid;gap:12px}
.item{padding:12px 0;border-bottom:1px solid rgba(0,0,0,.15)}
.item:last-child{border-bottom:none}

/* Z stacking */
.win{z-index:10}
.win.active{z-index:100}

/* Preloader */
#preloader{position:fixed;inset:0;background:#0a0a0a;display:flex;align-items:center;justify-content:center;z-index:9999;transition:opacity .35s ease}
.spinner{width:64px;height:64px;border-radius:50%;border:3px solid rgba(255,255,255,.12);border-top-color:#fff;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* Loader — forçar look moderno, independentemente do tema */
.preloader-inner{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:14px}
.lang-chooser{margin-top:10px;background:rgba(20,20,20,.72)!important;border:1px solid rgba(255,255,255,.16)!important;border-radius:12px!important;padding:16px 18px;backdrop-filter:blur(8px);color:#fff;box-shadow:0 20px 60px rgba(0,0,0,.45)}
.lang-title{font-weight:600;margin-bottom:10px;text-align:center}
.lang-buttons{display:flex;gap:10px;justify-content:center}
.lang-buttons .btn-rect{min-width:120px;border-radius:10px;border:1px solid rgba(255,255,255,.16);background:rgba(28,28,28,.6);color:#fff;box-shadow:none;padding:8px 14px}
.lang-buttons .btn-rect:hover{filter:none;transform:translateY(-1px)}

/* Player */
.player{
  display:flex;
  flex-direction:column;
  gap:12px;
  min-width:0;
}
.player .row{
  display:flex;
  align-items:center;
  gap:8px;
  min-width:0;
  flex-wrap:wrap;
}
/* Controls row (first row) */
.player > .row:first-child{
  flex-wrap:nowrap;
  gap:8px;
}
@media (max-width: 520px){
  .player > .row:first-child{ flex-wrap:wrap; }
}

.btn-rect{padding:4px 8px;border-radius:0;color:var(--win-text);cursor:pointer;background:var(--win-face);border:1px solid var(--win-dark);box-shadow: inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight)}
.btn-rect:hover{filter:brightness(1.05)}
.btn-rect.icon{
  width:36px; height:36px;
  display:inline-flex; align-items:center; justify-content:center;
  font-size:18px; line-height:1; padding:0; letter-spacing:0;
}

/* Now playing line inside player (no ellipsis; wraps) */
.track{
  font-variant-numeric:tabular-nums;
  letter-spacing:.3px;
  opacity:.95;
  white-space:normal;
  overflow:visible;
  text-overflow:clip;
  max-width:none;
  flex:1 1 auto;
  min-width:0;
  word-break:break-word;
}

/* VU */
.vu{ display:flex; gap:2px; align-items:flex-end; height:12px; flex:0 0 auto; }
.bar{width:3px;height:4px;background:#9cff7a;opacity:.85;transition:height .08s linear}
.player.playing .bar{height:calc(3px + 9px * var(--l,.5))}

/* Speaker toggle states */
.speaker{ min-width:36px }
.speaker-on{ background:var(--win-face); color:#0b7f00; border-color:var(--win-dark); }
.speaker-off{ background:var(--win-face); color:#b00000; border-color:var(--win-dark); }
body.theme-modern .speaker-on{ background:rgba(28,28,28,.55); color:#7CFF7C; border:1px solid rgba(255,255,255,.16) }
body.theme-modern .speaker-off{ background:rgba(28,28,28,.55); color:#FF7C7C; border:1px solid rgba(255,255,255,.16) }

/* About layout */
.about-layout{display:grid;grid-template-columns:240px 1fr;gap:16px;align-items:start}
.about-photo{width:100%;height:auto;display:block;border-radius:10px;object-fit:cover;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.about-copy{max-width:820px}
body.theme-modern .about-photo{border:1px solid rgba(255,255,255,.18)}
@media (max-width: 768px){
  .about-layout{grid-template-columns:1fr;gap:12px}
  .about-photo{max-width:420px;justify-self:center;border-radius:12px}
}

/* Subtle keyboard hints for taskbar */
.kbd-hints{
  font:11px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:var(--win-text);
  opacity:.8;
  padding:0 8px;
  border:1px solid var(--win-dark);
  background:var(--win-face);
  box-shadow:inset -1px -1px 0 var(--win-shadow), inset 1px 1px 0 var(--win-highlight);
  border-radius:0;
}

body.theme-modern .kbd-hints{
  color:#fff;
  border:1px solid rgba(255,255,255,.16);
  background:rgba(20,20,20,.45);
  box-shadow:none;
  border-radius:10px;
}

@media (max-width: 768px){
  .kbd-hints{ display:none }
}

/* Modern theme overrides (glassy) */
body.theme-modern{
  --bg:#0c0c0c;
  --ink:#ffffff;
  --muted:#e7e7e7;
  --win-text:#ffffff; /* força texto branco no tema moderno */
}
/* Taskbars glassy */
body.theme-modern .taskbar{ border:1px solid rgba(255,255,255,.12); border-radius:12px; backdrop-filter:blur(10px); box-shadow:none; background:rgba(12,12,12,.55); color:#fff; }
body.theme-modern .taskbar-top{ left:12px; right:12px; top:12px; height:48px; padding:8px 10px }
body.theme-modern .taskbar-bottom{ left:12px; right:12px; bottom:12px; height:48px; padding:8px 10px }
body.theme-modern .task-button{
  gap:8px; padding:8px 12px; height:32px; border-radius:10px; border:1px solid rgba(255,255,255,.16);
  background:rgba(20,20,20,.45); color:#fff; box-shadow:none; line-height:1;
}
body.theme-modern .task-button:hover{transform:translateY(-1px)}
body.theme-modern .task-button.pulsing::after{content:"";position:absolute;inset:-2px;border-radius:12px;border:1px solid rgba(255,255,255,.25);box-shadow:0 0 0 2px rgba(255,255,255,.06) inset}
body.theme-modern .task-controls{gap:10px}
body.theme-modern .theme-select, body.theme-modern .lang-select{
  height:32px; padding:0 10px; border-radius:10px; border:1px solid rgba(255,255,255,.16); background:rgba(20,20,20,.45); color:#fff; box-shadow:none; font:14px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial
}
body.theme-modern .task-clock{min-width:110px;height:32px;border:1px solid rgba(255,255,255,.16);border-radius:10px;background:rgba(20,20,20,.45);color:#fff;box-shadow:none}

/* Modern theme: mobile menu look (garantir override) */
body.theme-modern .mobile-menu{ 
  background:rgba(20,20,20,.72); 
  border:1px solid rgba(255,255,255,.16); 
  border-radius:12px; 
  backdrop-filter:blur(10px) saturate(110%);
  box-shadow:0 20px 60px rgba(0,0,0,.45);
  left:12px; right:auto; color:#fff;
}
body.theme-modern .mobile-menu .menu-item{
  border-radius:8px; border:1px solid rgba(255,255,255,.12); background:rgba(28,28,28,.55);
  color:#fff; box-shadow:none;
}
body.theme-modern .mobile-menu .menu-item + .menu-item{ margin-top:6px }

/* Modern theme – windows glassy */
body.theme-modern .win{
  background:rgba(25,25,25,.5);
  border:1px solid rgba(255,255,255,.18);
  box-shadow:0 12px 40px rgba(0,0,0,.35);
  border-radius:12px;
  backdrop-filter:blur(10px) saturate(110%);
}
body.theme-modern .titlebar{
  height:38px; padding:8px 10px;
  background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06));
  color:#fff; box-shadow:none; border-bottom:1px solid rgba(255,255,255,.12);
}
body.theme-modern .ctl{
  width:26px;height:24px;border-radius:6px;background:rgba(255,255,255,.12);color:#fff;border:1px solid rgba(255,255,255,.18);box-shadow:none;
}

body.theme-modern .content{ color:#fff }

/* Modern theme — buttons (incl. player controls) */
body.theme-modern .btn-rect{
  border-radius:10px;
  border:1px solid rgba(255,255,255,.16);
  background:rgba(28,28,28,.55);
  color:#fff;
  box-shadow:none;
  padding:6px 12px;
}
body.theme-modern .btn-rect.icon{
  width:36px;
  height:36px;
  font-size:18px;
  line-height:1;
  padding:0;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border-radius:10px;
}
body.theme-modern .btn-rect:hover{
  filter:none;
  transform:translateY(-1px);
}

/* Responsive: tabs colapsam -> hambúrguer na TOP bar */
@media (max-width: 1200px){
  .taskbar-top .tabs{ display:none !important }
  #tb-menu-top{ display:inline-flex !important; align-items:center; justify-content:center; }
}

/* Now Playing (na barra superior) */
.now-playing{
  display:flex; align-items:center; gap:8px;
  font:12px/1.2 Tahoma, "Microsoft Sans Serif", system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:var(--win-text); background:transparent; padding:0 8px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:42vw;
  border-left:1px solid rgba(0,0,0,.12); margin-left:auto;
}
.now-playing[hidden]{ display:none !important; }
body.theme-modern .now-playing{ color:#fff; border-left:1px solid rgba(255,255,255,.16); }
.now-playing .np-label{opacity:.85; margin-right:4px}
.now-playing .np-link{ color:inherit; text-decoration:underline }
body.theme-modern .now-playing .np-link{ color:#fff; text-decoration:underline }
.now-playing .np-link:hover{ filter:brightness(1.05) }